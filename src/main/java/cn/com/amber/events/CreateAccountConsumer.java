package cn.com.amber.events;import cn.com.amber.entity.Account;import lombok.extern.slf4j.Slf4j;import org.apache.rocketmq.client.consumer.listener.ConsumeConcurrentlyStatus;import org.springframework.stereotype.Component;import java.util.List;/** * example for consumer message * * @author yangying * @version 1.0 * @since 2022/9/18 **/@Slf4j@Componentpublic class CreateAccountConsumer extends AbstractConsumer{   /* public CreateAccountConsumer(String nameSrvAddress, String topic, String consumerGroup) {        super(nameSrvAddress, topic, consumerGroup);    }*/    @Override    public ConsumeConcurrentlyStatus consume(List<String> messages) {        for(String eventJson: messages){            try {                Event<Account> event = serializer.deserialize(eventJson);                Account account = event.getData();                log.info("收到事件key:{}", account.getAccountNo());            }catch (Exception e){                log.info("发生错误:{}",e.getMessage(),e);                return ConsumeConcurrentlyStatus.RECONSUME_LATER;            }        }        return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;    }}